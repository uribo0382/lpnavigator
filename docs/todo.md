# LP Navigator v1 - 開発TODOリスト

## プロジェクト概要
LP Navigator v1の本番環境移行と機能拡張のための開発計画です。各ユニットはユーザーストーリに沿って設計し、GherkinによるBDDテストを実装します。

## 開発アプローチ
- **ユーザーストーリ駆動開発**: 各機能をユーザーの視点で設計
- **BDDテスト**: Gherkin形式で振る舞いテストを記述
- **段階的実装**: 1ユニットずつ確実に実装・テスト
- **本番環境**: Vercel + Supabase での運用を前提

---

## Phase 1: 基盤整備

### 1.1 Supabase プロジェクト設定
**ユーザーストーリ**: 開発者として、Supabaseプロジェクトを設定し、データベースの基盤を構築したい

**受け入れ条件**:
- Supabaseプロジェクトが作成されている
- データベース接続が正常に動作する
- 環境変数が適切に設定されている

**BDDテスト**:
```gherkin
Feature: Supabase プロジェクト設定
  Scenario: プロジェクト作成と接続確認
    Given Supabaseアカウントが作成されている
    When 新しいプロジェクトを作成する
    And データベース接続設定を行う
    Then 接続が正常に確立される
    And 環境変数が設定される
```

**実装タスク**:
- [x] Supabaseアカウント作成
- [x] プロジェクト作成
- [x] データベース接続設定
- [x] 環境変数設定
- [x] 接続テスト

---

### 1.2 データベーススキーマ設計
**ユーザーストーリ**: 開発者として、アプリケーションに必要なデータベーステーブルを設計したい

**受け入れ条件**:
- 必要なテーブルがすべて作成されている
- リレーションシップが適切に設定されている
- インデックスが最適化されている

**BDDテスト**:
```gherkin
Feature: データベーススキーマ設計
  Scenario: テーブル作成とリレーション設定
    Given Supabaseプロジェクトが設定されている
    When 必要なテーブルを作成する
      | テーブル名 | 説明 |
      | users | ユーザー情報 |
      | questions | 質問データ |
      | formulas | フォーミュラデータ |
      | basic_infos | 基本情報 |
      | ad_copies | 広告文 |
      | lp_articles | LP記事 |
      | content_history | コンテンツ履歴 |
      | subscriptions | サブスクリプション情報 |
      | payments | 決済履歴 |
      | usage_logs | 使用量ログ |
      | plans | プラン情報 |
    And リレーションシップを設定する
    Then すべてのテーブルが正常に作成される
    And リレーションシップが機能する
```

**実装タスク**:
- [x] テーブル設計
- [x] リレーションシップ設計
- [x] インデックス設計
- [x] マイグレーションファイル作成
- [x] スキーマテスト

---

### 1.3 認証システム移行
**ユーザーストーリ**: ユーザーとして、Supabase認証を使用してログイン・ログアウトしたい

**受け入れ条件**:
- Supabase Authでログインできる
- ログアウトが正常に動作する
- セッション管理が適切に行われる

**BDDテスト**:
```gherkin
Feature: 認証システム
  Scenario: ユーザーログイン
    Given ユーザーが登録されている
    When 正しいメールアドレスとパスワードでログインする
    Then ログインが成功する
    And ダッシュボードにリダイレクトされる
    And セッションが作成される

  Scenario: ログイン失敗
    When 間違った認証情報でログインする
    Then エラーメッセージが表示される
    And ログイン画面に留まる

  Scenario: ユーザーログアウト
    Given ユーザーがログインしている
    When ログアウトボタンをクリックする
    Then ログアウトが成功する
    And ログイン画面にリダイレクトされる
    And セッションが削除される
```

**実装タスク**:
- [x] Supabase Auth設定
- [x] ログイン機能実装
- [x] ログアウト機能実装
- [x] セッション管理実装
- [x] 認証テスト

---

## Phase 2: データ移行

### 2.1 ユーザーデータ移行
**ユーザーストーリ**: 管理者として、既存のユーザーデータをSupabaseに移行したい

**受け入れ条件**:
- モックユーザーデータがSupabaseに移行される
- ユーザー情報が正常に表示される
- ユーザー管理機能が動作する

**BDDテスト**:
```gherkin
Feature: ユーザーデータ移行
  Scenario: ユーザーデータの移行
    Given モックユーザーデータが存在する
    When データ移行スクリプトを実行する
    Then すべてのユーザーデータがSupabaseに移行される
    And データの整合性が保たれる

  Scenario: ユーザー一覧表示
    Given ユーザーデータが移行されている
    When 管理者がユーザー管理画面にアクセスする
    Then ユーザー一覧が表示される
    And ユーザー情報が正しく表示される
```

**実装タスク**:
- [ ] データ移行スクリプト作成
- [ ] ユーザーデータ移行
- [ ] データ整合性チェック
- [ ] ユーザー管理機能テスト

---

### 2.2 質問データ移行
**ユーザーストーリ**: 管理者として、既存の質問データをSupabaseに移行したい

**受け入れ条件**:
- 21個の質問データがSupabaseに移行される
- 質問フローが正常に動作する
- 質問管理機能が動作する

**BDDテスト**:
```gherkin
Feature: 質問データ移行
  Scenario: 質問データの移行
    Given モック質問データが存在する
    When データ移行スクリプトを実行する
    Then すべての質問データがSupabaseに移行される
    And 質問の順序が保持される

  Scenario: 質問フロー動作
    Given 質問データが移行されている
    When ユーザーが質問フローを開始する
    Then 質問が順序通りに表示される
    And 回答が保存される
```

**実装タスク**:
- [ ] 質問データ移行スクリプト作成
- [ ] 質問データ移行
- [ ] 質問フロー機能テスト
- [ ] 質問管理機能テスト

---

### 2.3 フォーミュラデータ移行
**ユーザーストーリ**: 管理者として、既存のフォーミュラデータをSupabaseに移行したい

**受け入れ条件**:
- 13個のフォーミュラデータがSupabaseに移行される
- フォーミュラ管理機能が動作する
- コンテンツ生成でフォーミュラが使用される

**BDDテスト**:
```gherkin
Feature: フォーミュラデータ移行
  Scenario: フォーミュラデータの移行
    Given モックフォーミュラデータが存在する
    When データ移行スクリプトを実行する
    Then すべてのフォーミュラデータがSupabaseに移行される
    And フォーミュラの種類が保持される

  Scenario: フォーミュラ管理機能
    Given フォーミュラデータが移行されている
    When 管理者がフォーミュラ管理画面にアクセスする
    Then フォーミュラ一覧が表示される
    And フォーミュラの編集が可能である
```

**実装タスク**:
- [ ] フォーミュラデータ移行スクリプト作成
- [ ] フォーミュラデータ移行
- [ ] フォーミュラ管理機能テスト
- [ ] コンテンツ生成機能テスト

---

## Phase 3: AI API連携

### 3.1 OpenAI API連携
**ユーザーストーリ**: ユーザーとして、OpenAI APIを使用して高品質なコンテンツを生成したい

**受け入れ条件**:
- OpenAI APIに接続できる
- コンテンツ生成が正常に動作する
- エラーハンドリングが適切に行われる

**BDDテスト**:
```gherkin
Feature: OpenAI API連携
  Scenario: 基本情報生成
    Given ユーザーが質問に回答している
    When 基本情報生成ボタンをクリックする
    Then OpenAI APIが呼び出される
    And 高品質な基本情報が生成される
    And 生成結果が表示される

  Scenario: API エラーハンドリング
    Given OpenAI APIが利用できない状態
    When コンテンツ生成を試行する
    Then 適切なエラーメッセージが表示される
    And ユーザーに再試行の選択肢が提供される
```

**実装タスク**:
- [x] OpenAI API設定
- [x] API クライアント実装
- [x] 基本情報生成機能実装
- [x] エラーハンドリング実装
- [x] API テスト

---

### 3.2 Anthropic API連携
**ユーザーストーリ**: ユーザーとして、Claude APIを使用して多様なコンテンツを生成したい

**受け入れ条件**:
- Anthropic APIに接続できる
- Claude 3 Opusでコンテンツ生成が動作する
- 生成品質が向上する

**BDDテスト**:
```gherkin
Feature: Anthropic API連携
  Scenario: Claude 3 Opus によるコンテンツ生成
    Given ユーザーが基本情報を入力している
    When Claude 3 Opus でコンテンツ生成を実行する
    Then 高品質なコンテンツが生成される
    And 生成時間が適切である

  Scenario: 複数モデル比較
    Given 複数のAIモデルが利用可能
    When 同じ入力で複数モデルを実行する
    Then 各モデルの結果が比較表示される
    And ユーザーが最適な結果を選択できる
```

**実装タスク**:
- [x] Anthropic API設定
- [x] Claude 3 Opus 実装
- [x] 複数モデル比較機能実装
- [x] 生成品質評価機能実装
- [x] API テスト

---

### 3.3 Google AI API連携
**ユーザーストーリ**: ユーザーとして、Gemini APIを使用して最新のAI技術でコンテンツを生成したい

**受け入れ条件**:
- Google AI APIに接続できる
- Gemini Proでコンテンツ生成が動作する
- 生成速度が最適化されている

**BDDテスト**:
```gherkin
Feature: Google AI API連携
  Scenario: Gemini Pro によるコンテンツ生成
    Given ユーザーが基本情報を入力している
    When Gemini Pro でコンテンツ生成を実行する
    Then 高速でコンテンツが生成される
    And 生成品質が高い

  Scenario: API レート制限対応
    Given API レート制限に達している
    When コンテンツ生成を試行する
    Then 適切な待機時間が表示される
    And 自動リトライが実行される
```

**実装タスク**:
- [x] Google AI API設定
- [x] Gemini Pro 実装
- [x] レート制限対応実装
- [x] 自動リトライ機能実装
- [x] API テスト

---

### 3.4 AI連携と動的機能化
**ユーザーストーリ**: ユーザーおよび管理者として、AIエージェントのAPIを連携し、現在モックで表現されている各ページを動的に機能・表示させたい

**概要**: AI エージェントのAPIを連携できるようにするのと同時に、今モックで表現されてる各ページを動的に動作と表示するようにして行く。

#### ユーザー・管理者共通機能

##### 3.4.1 コンテンツジェネレーター（`/#/generator`）の動的化
**受け入れ条件**:
- 既存のモックデータや用意されてるファイル、DBのテーブル構造を調査し読み取り、どんな機能や表示が想定されているかを把握する
- 読み取った情報をもとに、動的に機能、表示するように修正する

**実装タスク**:
- [ ] 既存のモックデータや用意されてるファイル、DBのテーブル構造を調査し読み取り、どんな機能や表示が想定されているかを把握
- [ ] 読み取った情報をもとに、動的に機能、表示するように修正。テーブルにカラムの追加が必要であれば私がSQL文でGUI上で実行できるように出力

##### 3.4.2 コンテンツ履歴（`/#/generator/history`）の動的化
**受け入れ条件**:
- 既存のモックデータや用意されてるファイル、DBのテーブル構造を調査し読み取り、どんな機能や表示が想定されているかを把握する
- 読み取った情報をもとに、動的に機能、表示するように修正する

**実装タスク**:
- [ ] 既存のモックデータや用意されてるファイル、DBのテーブル構造を調査し読み取り、どんな機能や表示が想定されているかを把握
- [ ] 読み取った情報をもとに、動的に機能、表示するように修正。テーブルにカラムの追加が必要であれば私がSQL文でGUI上で実行できるように出力

##### 3.4.3 広告文生成（`/#/generator/adcopy/create`）の動的化
**受け入れ条件**:
- 既存のモックデータや用意されてるファイル、DBのテーブル構造を調査し読み取り、どんな機能や表示が想定されているかを把握する
- 読み取った情報をもとに、動的に機能、表示するように修正する

**実装タスク**:
- [ ] 既存のモックデータや用意されてるファイル、DBのテーブル構造を調査し読み取り、どんな機能や表示が想定されているかを把握
- [ ] 読み取った情報をもとに、動的に機能、表示するように修正。テーブルにカラムの追加が必要であれば私がSQL文でGUI上で実行できるように出力

##### 3.4.4 広告文履歴（`/#/generator/adcopy/history`）の動的化
**受け入れ条件**:
- 既存のモックデータや用意されてるファイル、DBのテーブル構造を調査し読み取り、どんな機能や表示が想定されているかを把握する
- 読み取った情報をもとに、動的に機能、表示するように修正する

**実装タスク**:
- [ ] 既存のモックデータや用意されてるファイル、DBのテーブル構造を調査し読み取り、どんな機能や表示が想定されているかを把握
- [ ] 読み取った情報をもとに、動的に機能、表示するように修正。テーブルにカラムの追加が必要であれば私がSQL文でGUI上で実行できるように出力

##### 3.4.5 LP記事履歴（`/#/generator/lparticle/history`）の動的化
**受け入れ条件**:
- 既存のモックデータや用意されてるファイル、DBのテーブル構造を調査し読み取り、どんな機能や表示が想定されているかを把握する
- 読み取った情報をもとに、動的に機能、表示するように修正する

**実装タスク**:
- [ ] 既存のモックデータや用意されてるファイル、DBのテーブル構造を調査し読み取り、どんな機能や表示が想定されているかを把握
- [ ] 読み取った情報をもとに、動的に機能、表示するように修正。テーブルにカラムの追加が必要であれば私がSQL文でGUI上で実行できるように出力

#### 管理者機能

##### 3.4.6 質問管理（`/#/admin/questions`）の動的化
**受け入れ条件**:
- 既存のモックデータや用意されてるファイル、DBのテーブル構造を調査し読み取り、どんな機能や表示が想定されているかを把握する
- 読み取った情報をもとに、動的に機能、表示するように修正する

**実装タスク**:
- [ ] 既存のモックデータや用意されてるファイル、DBのテーブル構造を調査し読み取り、どんな機能や表示が想定されているかを把握
- [ ] 読み取った情報をもとに、動的に機能、表示するように修正。テーブルにカラムの追加が必要であれば私がSQL文でGUI上で実行できるように出力

##### 3.4.7 基本情報フォーミュラ（`/#/admin/formula/basic-info`）の動的化
**受け入れ条件**:
- 既存のモックデータや用意されてるファイル、DBのテーブル構造を調査し読み取り、どんな機能や表示が想定されているかを把握する
- 読み取った情報をもとに、動的に機能、表示するように修正する

**実装タスク**:
- [ ] 既存のモックデータや用意されてるファイル、DBのテーブル構造を調査し読み取り、どんな機能や表示が想定されているかを把握
- [ ] 読み取った情報をもとに、動的に機能、表示するように修正。テーブルにカラムの追加が必要であれば私がSQL文でGUI上で実行できるように出力

##### 3.4.8 広告文フォーミュラ（`/#/admin/formula/ad-copy`）の動的化
**受け入れ条件**:
- 既存のモックデータや用意されてるファイル、DBのテーブル構造を調査し読み取り、どんな機能や表示が想定されているかを把握する
- 読み取った情報をもとに、動的に機能、表示するように修正する

**実装タスク**:
- [ ] 既存のモックデータや用意されてるファイル、DBのテーブル構造を調査し読み取り、どんな機能や表示が想定されているかを把握
- [ ] 読み取った情報をもとに、動的に機能、表示するように修正。テーブルにカラムの追加が必要であれば私がSQL文でGUI上で実行できるように出力

##### 3.4.9 LP記事フォーミュラ（`/#/admin/formula/lp-article`）の動的化
**受け入れ条件**:
- 既存のモックデータや用意されてるファイル、DBのテーブル構造を調査し読み取り、どんな機能や表示が想定されているかを把握する
- 読み取った情報をもとに、動的に機能、表示するように修正する

**実装タスク**:
- [ ] 既存のモックデータや用意されてるファイル、DBのテーブル構造を調査し読み取り、どんな機能や表示が想定されているかを把握
- [ ] 読み取った情報をもとに、動的に機能、表示するように修正。テーブルにカラムの追加が必要であれば私がSQL文でGUI上で実行できるように出力

##### 3.4.10 ユーザー管理（`/#/admin/users`）の動的化
**受け入れ条件**:
- 既存のモックデータや用意されてるファイル、DBのテーブル構造を調査し読み取り、どんな機能や表示が想定されているかを把握する
- 読み取った情報をもとに、動的に機能、表示するように修正する

**実装タスク**:
- [ ] 既存のモックデータや用意されてるファイル、DBのテーブル構造を調査し読み取り、どんな機能や表示が想定されているかを把握
- [ ] 読み取った情報をもとに、動的に機能、表示するように修正。テーブルにカラムの追加が必要であれば私がSQL文でGUI上で実行できるように出力

---

## Phase 4: 課金・プラン管理システム

### 4.1 プラン管理システム
**ユーザーストーリ**: ユーザーとして、自分のプランを確認し、必要に応じてアップグレードしたい

**受け入れ条件**:
- 3つのプラン（フリー、スタンダード、プレミアム）が表示される
- 現在のプランが明確に表示される
- プラン比較ができる
- アップグレード・ダウングレードが可能

**BDDテスト**:
```gherkin
Feature: プラン管理システム
  Scenario: プラン一覧表示
    Given ユーザーがログインしている
    When プランページにアクセスする
    Then 3つのプランが表示される
    And 現在のプランがハイライトされる
    And プランの特徴が比較表示される

  Scenario: プラン詳細表示
    Given ユーザーがプランページにいる
    When プランの詳細ボタンをクリックする
    Then プランの詳細情報が表示される
    And 機能制限が明確に表示される
    And 価格情報が表示される

  Scenario: プラン変更
    Given ユーザーが現在のプランと異なるプランを選択する
    When プラン変更ボタンをクリックする
    Then プラン変更確認画面が表示される
    And 変更内容が明確に表示される
```

**実装タスク**:
- [ ] プランページ作成
- [ ] プラン比較機能実装
- [ ] 現在プラン表示機能実装
- [ ] プラン変更機能実装
- [ ] プラン管理テスト

---

### 4.2 Stripe 決済システム
**ユーザーストーリ**: ユーザーとして、安全にクレジットカードで月額料金を支払いたい

**受け入れ条件**:
- Stripe による安全な決済ができる
- 月額課金が自動で行われる
- 決済履歴が確認できる
- 請求書がダウンロードできる

**BDDテスト**:
```gherkin
Feature: Stripe 決済システム
  Scenario: 初回決済
    Given ユーザーがプランを選択している
    When 決済ボタンをクリックする
    Then Stripe 決済画面が表示される
    And クレジットカード情報を入力できる
    And 決済が完了する

  Scenario: 月額自動課金
    Given ユーザーが有料プランに加入している
    When 月額課金日が到来する
    Then 自動で課金が実行される
    And ユーザーに通知が送信される
    And 請求書が生成される

  Scenario: 決済失敗処理
    Given ユーザーのクレジットカードが期限切れ
    When 月額課金が実行される
    Then 決済が失敗する
    And ユーザーに通知が送信される
    And 決済情報更新画面が表示される
```

**実装タスク**:
- [ ] Stripe アカウント設定
- [ ] Stripe API 連携実装
- [ ] 決済画面実装
- [ ] 自動課金機能実装
- [ ] 決済履歴機能実装
- [ ] 請求書生成機能実装
- [ ] 決済テスト

---

### 4.3 プラン別権限管理
**ユーザーストーリ**: ユーザーとして、自分のプランに応じた機能制限を理解し、適切に利用したい

**受け入れ条件**:
- プラン別の機能制限が適用される
- 制限に達した場合の適切な通知が表示される
- アップグレード案内が表示される

**BDDテスト**:
```gherkin
Feature: プラン別権限管理
  Scenario: フリープラン制限
    Given ユーザーがフリープランに加入している
    When 月間生成回数制限に達する
    Then 制限通知が表示される
    And アップグレード案内が表示される
    And 追加生成が制限される

  Scenario: スタンダードプラン機能
    Given ユーザーがスタンダードプランに加入している
    When コンテンツ生成を実行する
    Then 月間制限内で生成が可能である
    And 基本機能が利用できる
    And 高度な機能は制限される

  Scenario: プレミアムプラン機能
    Given ユーザーがプレミアムプランに加入している
    When 任意の機能を利用する
    Then すべての機能が利用できる
    And 制限が適用されない
    And 優先サポートが利用できる
```

**実装タスク**:
- [ ] プラン別制限ロジック実装
- [ ] 制限通知機能実装
- [ ] アップグレード案内機能実装
- [ ] 権限チェック機能実装
- [ ] 権限管理テスト

---

### 4.4 使用量管理・監視
**ユーザーストーリ**: ユーザーとして、自分の使用量を確認し、プランに応じた利用を管理したい

**受け入れ条件**:
- 月間使用量が表示される
- 制限までの残りが表示される
- 使用量の詳細が確認できる

**BDDテスト**:
```gherkin
Feature: 使用量管理・監視
  Scenario: 使用量表示
    Given ユーザーがログインしている
    When ダッシュボードにアクセスする
    Then 月間使用量が表示される
    And 制限までの残りが表示される
    And 使用量の内訳が表示される

  Scenario: 使用量詳細
    Given ユーザーが使用量を確認したい
    When 使用量詳細ボタンをクリックする
    Then 日別使用量が表示される
    And 機能別使用量が表示される
    And 使用量の推移グラフが表示される

  Scenario: 使用量アラート
    Given ユーザーが制限の80%に達している
    When コンテンツ生成を実行する
    Then 使用量アラートが表示される
    And 残り使用量が強調表示される
    And アップグレード案内が表示される
```

**実装タスク**:
- [ ] 使用量追跡機能実装
- [ ] 使用量表示機能実装
- [ ] 使用量詳細機能実装
- [ ] 使用量アラート機能実装
- [ ] 使用量管理テスト

---

### 4.5 サブスクリプション管理
**ユーザーストーリ**: ユーザーとして、自分のサブスクリプションを管理し、必要に応じて変更したい

**受け入れ条件**:
- サブスクリプション状況が確認できる
- プラン変更ができる
- 解約ができる
- 請求履歴が確認できる

**BDDテスト**:
```gherkin
Feature: サブスクリプション管理
  Scenario: サブスクリプション状況確認
    Given ユーザーがログインしている
    When アカウント設定にアクセスする
    Then 現在のサブスクリプション状況が表示される
    And 次回課金日が表示される
    And プラン詳細が表示される

  Scenario: プラン変更
    Given ユーザーがサブスクリプション管理画面にいる
    When プラン変更ボタンをクリックする
    Then プラン選択画面が表示される
    And 変更内容が確認できる
    And 決済が実行される

  Scenario: サブスクリプション解約
    Given ユーザーがサブスクリプションを解約したい
    When 解約ボタンをクリックする
    Then 解約確認画面が表示される
    And 解約理由を選択できる
    And 解約が完了する
```

**実装タスク**:
- [ ] サブスクリプション管理画面実装
- [ ] プラン変更機能実装
- [ ] 解約機能実装
- [ ] 請求履歴機能実装
- [ ] サブスクリプション管理テスト

---

## Phase 5: 機能拡張

### 5.1 ファイルアップロード機能
**ユーザーストーリ**: ユーザーとして、画像やドキュメントをアップロードしてコンテンツに活用したい

**受け入れ条件**:
- ファイルアップロードが動作する
- 画像の最適化が行われる
- ファイルサイズ制限が適切に設定されている

**BDDテスト**:
```gherkin
Feature: ファイルアップロード
  Scenario: 画像アップロード
    Given ユーザーがログインしている
    When 画像ファイルをアップロードする
    Then ファイルが正常にアップロードされる
    And 画像が最適化される
    And プレビューが表示される

  Scenario: ファイルサイズ制限
    Given ファイルサイズ制限が設定されている
    When 制限を超えるファイルをアップロードする
    Then エラーメッセージが表示される
    And アップロードが拒否される
```

**実装タスク**:
- [ ] ファイルアップロード機能実装
- [ ] 画像最適化機能実装
- [ ] ファイルサイズ制限実装
- [ ] プレビュー機能実装
- [ ] アップロードテスト

---

### 4.2 エクスポート機能
**ユーザーストーリ**: ユーザーとして、生成したコンテンツをPDFやWord形式でエクスポートしたい

**受け入れ条件**:
- PDF エクスポートが動作する
- Word エクスポートが動作する
- HTML エクスポートが動作する

**BDDテスト**:
```gherkin
Feature: エクスポート機能
  Scenario: PDF エクスポート
    Given ユーザーがコンテンツを生成している
    When PDF エクスポートボタンをクリックする
    Then PDF ファイルが生成される
    And ファイルがダウンロードされる
    And レイアウトが適切である

  Scenario: Word エクスポート
    Given ユーザーがコンテンツを生成している
    When Word エクスポートボタンをクリックする
    Then Word ファイルが生成される
    And ファイルがダウンロードされる
    And フォーマットが保持される
```

**実装タスク**:
- [ ] PDF エクスポート機能実装
- [ ] Word エクスポート機能実装
- [ ] HTML エクスポート機能実装
- [ ] ファイル生成テスト
- [ ] ダウンロードテスト

---

### 4.3 チーム機能
**ユーザーストーリ**: チームメンバーとして、他のメンバーとコンテンツを共有・協力して作成したい

**受け入れ条件**:
- チーム作成ができる
- メンバー招待ができる
- コンテンツ共有ができる

**BDDテスト**:
```gherkin
Feature: チーム機能
  Scenario: チーム作成
    Given ユーザーがログインしている
    When チーム作成ボタンをクリックする
    And チーム情報を入力する
    Then チームが作成される
    And ユーザーがチームオーナーになる

  Scenario: メンバー招待
    Given チームが作成されている
    When メンバー招待ボタンをクリックする
    And メールアドレスを入力する
    Then 招待メールが送信される
    And メンバーがチームに参加できる
```

**実装タスク**:
- [ ] チーム作成機能実装
- [ ] メンバー招待機能実装
- [ ] コンテンツ共有機能実装
- [ ] 権限管理機能実装
- [ ] チーム機能テスト

---

## Phase 5: 最適化

### 5.1 パフォーマンス最適化
**ユーザーストーリ**: ユーザーとして、アプリケーションが高速に動作することを期待したい

**受け入れ条件**:
- ページ読み込み時間が3秒以内
- API レスポンス時間が2秒以内
- メモリ使用量が最適化されている

**BDDテスト**:
```gherkin
Feature: パフォーマンス最適化
  Scenario: ページ読み込み速度
    Given ユーザーがアプリケーションにアクセスする
    When ページが読み込まれる
    Then 読み込み時間が3秒以内である
    And ユーザーインターフェースが表示される

  Scenario: API レスポンス速度
    Given ユーザーがコンテンツ生成を実行する
    When API リクエストが送信される
    Then レスポンス時間が2秒以内である
    And 結果が正常に返される
```

**実装タスク**:
- [ ] コード分割実装
- [ ] 画像最適化実装
- [ ] キャッシュ戦略実装
- [ ] パフォーマンステスト
- [ ] 最適化効果測定

---

### 5.2 SEO 対策
**ユーザーストーリ**: ユーザーとして、生成したコンテンツが検索エンジンで適切にインデックスされることを期待したい

**受け入れ条件**:
- メタタグが適切に生成される
- 構造化データが含まれる
- ページ速度が最適化されている

**BDDテスト**:
```gherkin
Feature: SEO 対策
  Scenario: メタタグ生成
    Given ユーザーがコンテンツを生成している
    When コンテンツが完成する
    Then 適切なメタタグが生成される
    And 検索エンジンで認識される

  Scenario: 構造化データ
    Given コンテンツが生成されている
    When ページが表示される
    Then 構造化データが含まれる
    And リッチスニペットが表示される
```

**実装タスク**:
- [ ] メタタグ生成機能実装
- [ ] 構造化データ実装
- [ ] サイトマップ生成実装
- [ ] SEO テスト
- [ ] 検索エンジン最適化

---

### 5.3 アクセシビリティ対応
**ユーザーストーリ**: 障害を持つユーザーとして、アプリケーションを適切に利用したい

**受け入れ条件**:
- スクリーンリーダーで読み取れる
- キーボード操作が可能
- 色のコントラストが適切

**BDDテスト**:
```gherkin
Feature: アクセシビリティ対応
  Scenario: スクリーンリーダー対応
    Given ユーザーがスクリーンリーダーを使用している
    When ページにアクセスする
    Then コンテンツが適切に読み取られる
    And ナビゲーションが理解できる

  Scenario: キーボード操作
    Given ユーザーがキーボードのみで操作する
    When ページを操作する
    Then すべての機能にアクセスできる
    And フォーカスが適切に移動する
```

**実装タスク**:
- [ ] ARIA 属性実装
- [ ] キーボード操作対応実装
- [ ] 色のコントラスト調整実装
- [ ] アクセシビリティテスト
- [ ] ユーザビリティテスト

---

## テスト戦略

### BDD テスト実装
各ユニットの実装と並行して、Gherkin形式のBDDテストを実装します。

**テストツール**:
- **Cucumber**: BDD テストフレームワーク
- **Playwright**: ブラウザ自動化テスト
- **Jest**: ユニットテスト
- **Cypress**: E2E テスト

**テスト環境**:
- **開発環境**: ローカル開発
- **ステージング環境**: 本番前テスト
- **本番環境**: 本番運用

### 継続的インテグレーション
- **GitHub Actions**: CI/CD パイプライン
- **自動テスト**: プルリクエスト時の自動実行
- **デプロイ**: ステージング・本番への自動デプロイ

---

## 開発スケジュール

### Phase 1: 基盤整備 (2週間)
- Week 1: Supabase 設定、データベース設計
- Week 2: 認証システム移行

### Phase 2: データ移行 (1週間)
- Week 3: データ移行、機能テスト

### Phase 3: AI API連携 (3週間)
- Week 4: OpenAI API連携
- Week 5: Anthropic API連携
- Week 6: Google AI API連携

### Phase 4: 課金・プラン管理システム (4週間)
- Week 7: プラン管理システム、Stripe 決済システム
- Week 8: プラン別権限管理、使用量管理・監視
- Week 9: サブスクリプション管理
- Week 10: 課金システム統合テスト

### Phase 5: 機能拡張 (2週間)
- Week 11: ファイルアップロード、エクスポート機能
- Week 12: チーム機能

### Phase 6: 最適化 (2週間)
- Week 13: パフォーマンス最適化、SEO対策
- Week 14: アクセシビリティ対応、最終テスト

---

## リスク管理

### 技術的リスク
- **API 制限**: レート制限による機能制限
- **データ移行**: データ損失の可能性
- **パフォーマンス**: 大量データ処理時の性能問題
- **決済システム**: Stripe API の障害や制限
- **課金エラー**: 決済失敗によるユーザー体験の悪化

### 対策
- **段階的移行**: リスクを最小化する段階的実装
- **バックアップ**: データの定期的なバックアップ
- **監視**: パフォーマンス監視とアラート設定
- **決済監視**: Stripe ダッシュボードでの監視
- **エラーハンドリング**: 決済エラー時の適切な処理

---

## 成功指標

### 技術指標
- **ページ読み込み時間**: 3秒以内
- **API レスポンス時間**: 2秒以内
- **エラー率**: 1%以下
- **テストカバレッジ**: 90%以上

### ビジネス指標
- **ユーザー満足度**: 4.5/5以上
- **機能利用率**: 80%以上
- **サポート問い合わせ**: 月10件以下
- **課金成功率**: 95%以上
- **プラン変更率**: 月5%以下
- **解約率**: 月3%以下

---

## まとめ

このTODOリストは、LP Navigator v1の本番環境移行と機能拡張を段階的に進めるための詳細な計画です。各ユニットはユーザーストーリに基づいて設計され、BDDテストにより品質を保証します。

**重要なポイント**:
- 段階的実装によるリスク最小化
- ユーザー中心の設計
- 包括的なテスト戦略
- 継続的な品質改善
- **月額課金システム**: Stripe による安全な決済
- **プラン管理**: 3つのプラン（フリー、スタンダード、プレミアム）
- **権限管理**: プラン別の機能制限と使用量管理

**新しく追加された機能**:
- プラン管理システム
- Stripe 決済システム
- プラン別権限管理
- 使用量管理・監視
- サブスクリプション管理

この計画に従って開発を進めることで、高品質で使いやすく、収益化されたアプリケーションを構築できます。
